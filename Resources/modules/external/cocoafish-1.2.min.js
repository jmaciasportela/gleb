(function(a){a.cors=function(b){b.success=b.success||function(c,d){alert("no success callback specified")};b.error=b.error||function(f,d,c){alert("no fail callback specified")};a.ajax(b)};a.corsSetup=function(b){a.ajaxSetup(b)};a.getCORS=function(c,f,h,d,g,b){options={url:c,type:"GET",data:f,success:h,dataType:d,error:h,headers:g,xhrFields:b};a.cors(options)};a.postCORS=function(c,f,h,d,g,b){options={url:c,type:"POST",data:f,success:h,dataType:d,error:h,headers:g,xhrFields:b};a.cors(options)};a.putCORS=function(c,f,h,d,g,b){options={url:c,type:"PUT",data:f,success:h,dataType:d,error:h,headers:g,xhrFields:b};a.cors(options)};a.deleteCORS=function(c,f,h,d,g,b){options={url:c,type:"DELETE",data:f,success:h,dataType:d,error:h,headers:g,xhrFields:b};a.cors(options)};a.postCORSWithFile=function(c,f,h,d,g,b){options={url:c,type:"POST",data:f,success:h,dataType:d,error:h,headers:g,cache:false,contentType:false,processData:false,xhrFields:b};a.cors(options)};a.postJSON=function(b,c,d){a.ajaxSetup({contentType:"application/json; charset=utf-8"});a.postCORS(b,JSON.stringify(c),d,"json")};a.putJSON=function(b,c,d){a.ajaxSetup({contentType:"application/json; charset=utf-8"});a.putCORS(b,JSON.stringify(c),d,"json")};a.deleteJSON=function(b,c,d){a.deleteCORS(b,c,d,"json")};a.corsJSON=function(d,c,f,g,b){a.ajaxSetup({error:b,contentType:"application/json; charset=utf-8"});a.cors({type:d,url:c,data:f,dataType:"json",success:g,error:b})};a.getURLParameter=function(b){return decodeURIComponent((new RegExp("[#|?|&]"+b+"=([^&;]+?)(&|#|;|$)").exec(location.hash)||[,""])[1].replace(/\+/g,"%20"))||null}})(jQuery);$.ajaxTransport("+*",function(b,d,c){if(jQuery.browser.msie&&window.XDomainRequest){var a;return{send:function(g,f){a=new XDomainRequest();a.open(b.type,b.url);a.onload=function(){if(this.contentType.match(/\/xml/)){var h=new ActiveXObject("Microsoft.XMLDOM");h.async=false;h.loadXML(this.responseText);f(200,"success",[h])}else{f(200,"success",[this.responseText])}};a.ontimeout=function(){f(408,"error",["Request timed out."])};a.onerror=function(){f(404,"error",["The requested resource could not be found."])};a.send(b.data)},abort:function(){if(a){a.abort()}}}}});jQuery.proxy_xmlhttp=function(x){var f=1500;var i=x||"http://"+window.location.hostname+"/xmlhttp/";this.status=null;this.statusText=null;this.responseText=null;this.responseXML=null;this.synchronous=false;this.readyState=0;this.onreadystatechange=function(){};this.onerror=function(){};this.onload=function(){};this.abort=function(){k=true;u()};this.getAllResponseHeaders=function(){var B="";for(var C in t){B+=C+": "+t[C]+"\r\n"}return B};this.getResponseHeader=function(B){for(var C in t){if(C.toLowerCase()==B.toLowerCase()){return t[C]}}return null};this.overrideMimeType=function(B){j=B};this.open=function(F,C,D,E,B){if(!w(F,C)){return}o=(F)?F:"";l=(C)?C:"";s=(E)?E:"";h=(B)?B:"";b(1)};this.openRequest=function(F,C,D,E,B){return this.open(F,C,D,E,B)};this.send=function(B){if(k){return}var C=n(B);A(C)};this.setRequestHeader=function(B,D){if(k){return}for(var C in d){if(C.toLowerCase()==B.toLowerCase()){d[C]=D;return}}d[B]=D};var o="";var l="";var s="";var h="";var d={"HTTP-Referer":escape(document.location),"Content-Type":"application/x-www-form-urlencoded"};var t={};var j="";var p=this;var c="";var q=[];var k=false;var g=function(B){p.onerror(B);p.abort();return false};var n=function(E){if(!E){E=""}var C="";for(var K in d){C+=K+"="+d[K]+"&"}var J=o+"$"+c+"$"+s+"$"+h+"$"+C+"$"+a(E)+"$"+l;var B=J;var I=f,D=[];var H=Math.floor(B.length/I),F=0;while(B.length>0){var G=i+"?multipart$"+c+"$"+F+++"$"+H+"$"+B.substr(0,I);D.push(G);B=B.substr(I)}if(D.length==1){B=i+"?"+J}else{B=D}return B};var w=function(C,B){if(!C){return g("Please, specify the query method (GET, POST or HEAD)")}if(!B){return g("Please, specify the URL")}if(C.toLowerCase()!="get"&&C.toLowerCase()!="post"&&C.toLowerCase()!="put"&&C.toLowerCase()!="delete"&&C.toLowerCase()!="options"&&C.toLowerCase()!="head"){return g("Please, specify either a GET, POST or a HEAD method")}if(B.toLowerCase().substr(0,7)!="http://"){return g("Only HTTP protocol is supported (http://)")}return true};var A=function(D){if("object"==typeof D){for(var C=0;C<D.length;C++){A(D[C])}return true}var B=document.createElement("script");B.src=D;B.type="text/javascript";if(navigator.userAgent.indexOf("Safari")){B.charset="utf-8"}B=document.getElementsByTagName("head")[0].appendChild(B);q.push(B);return B};var a=function(B){B=escape(B);B=B.replace("+","%2B");return B};var u=function(){for(var B=0;B<q.length;B++){if(q[B].parentNode){q[B].parentNode.removeChild(q[B])}}};var m=function(){c="v"+Math.random().toString().substr(2);window[c]=p};var b=function(B){p.readyState=B;p.onreadystatechange();if(B==4){p.onload()}};var r=function(){var C=p.getResponseHeader("Content-type")+j;if(!(C.indexOf("html")>-1||C.indexOf("xml")>-1)){return}var B;if(document.implementation&&document.implementation.createDocument&&navigator.userAgent.indexOf("Opera")==-1){var D=new DOMParser();B=D.parseFromString(p.responseText,"text/xml");p.responseXML=B}else{if(window.ActiveXObject){B=new ActiveXObject("MSXML2.DOMDocument.3.0");if(B.loadXML(p.responseText)){p.responseXML=B}}else{B=document.body.appendChild(document.createElement("div"));B.style.display="none";B.innerHTML=p.responseText;z(B,true);p.responseXML=B.childNodes[0];document.body.removeChild(B)}}};var z=function(D,B){var C=D.childNodes.length;if(C===0){return}do{var E=D.childNodes[--C];if(E.nodeType==3&&!y(E.nodeValue)){D.removeChild(E)}if(E.nodeType==1&&B){z(E,true)}}while(C>0)};var y=function(B){B=B.replace("\r","");B=B.replace("\n","");B=B.replace(" ","");return(B.length===0)?false:true};this._parse=function(B){if(k){return true}if(B.multipart){return true}if(!B.success){return g(B.description)}t=B.responseHeaders;this.status=B.status;this.statusText=B.statusText;this.responseText=B.responseText;r();u();b(4);return true};m()};(function(a,f){if(a.cleanData){var d=a.cleanData;a.cleanData=function(b){for(var i=0,h;(h=b[i])!=null;i++){try{a(h).triggerHandler("remove")}catch(g){}}d(b)}}else{var c=a.fn.remove;a.fn.remove=function(b,g){return this.each(function(){if(!g){if(!b||a.filter(b,[this]).length){a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(h){}})}}return c.call(a(this),b,g)})}}a.widget=function(b,j,i){var h=b.split(".")[0],g;b=b.split(".")[1];g=h+"-"+b;if(!i){i=j;j=a.Widget}a.expr[":"][g]=function(k){return !!a.data(k,b)};a[h]=a[h]||{};a[h][b]=function(k,l){arguments.length&&this._createWidget(k,l)};j=new j;j.options=a.extend(true,{},j.options);a[h][b].prototype=a.extend(true,j,{namespace:h,widgetName:b,widgetEventPrefix:a[h][b].prototype.widgetEventPrefix||b,widgetBaseClass:g},i);a.widget.bridge(b,a[h][b])};a.widget.bridge=function(b,g){a.fn[b]=function(l){var k=typeof l==="string",j=Array.prototype.slice.call(arguments,1),i=this;l=!k&&j.length?a.extend.apply(null,[true,l].concat(j)):l;if(k&&l.charAt(0)==="_"){return i}k?this.each(function(){var m=a.data(this,b),h=m&&a.isFunction(m[l])?m[l].apply(m,j):m;if(h!==m&&h!==f){i=h;return false}}):this.each(function(){var h=a.data(this,b);h?h.option(l||{})._init():a.data(this,b,new g(l,this))});return i}};a.Widget=function(b,g){arguments.length&&this._createWidget(b,g)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(b,h){a.data(h,this.widgetName,this);this.element=a(h);this.options=a.extend(true,{},this.options,this._getCreateOptions(),b);var g=this;this.element.bind("remove."+this.widgetName,function(){g.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(b,h){var g=b;if(arguments.length===0){return a.extend({},this.options)}if(typeof b==="string"){if(h===f){return this.options[b]}g={};g[b]=h}this._setOptions(g);return this},_setOptions:function(b){var g=this;a.each(b,function(i,h){g._setOption(i,h)});return this},_setOption:function(b,g){this.options[b]=g;if(b==="disabled"){this.widget()[g?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",g)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(b,j,i){var h=this.options[b];j=a.Event(j);j.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();i=i||{};if(j.originalEvent){b=a.event.props.length;for(var g;b;){g=a.event.props[--b];j[g]=j.originalEvent[g]}}this.element.trigger(j,i);return !(a.isFunction(h)&&h.call(this.element[0],j,i)===false||j.isDefaultPrevented())}}})(jQuery);(function(a){a.widget("blueimp.fileupload",{options:{namespace:undefined,dropZone:a(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,formData:function(b){return b.serializeArray()},add:function(c,b){b.submit()},processData:false,contentType:false,cache:false},_refreshOptionsList:["namespace","dropZone","fileInput"],_isXHRUpload:function(b){var c="undefined";return !b.forceIframeTransport&&typeof XMLHttpRequestUpload!==c&&typeof File!==c&&(!b.multipart||typeof FormData!==c)},_getFormData:function(b){var c;if(typeof b.formData==="function"){return b.formData(b.form)}else{if(a.isArray(b.formData)){return b.formData}else{if(b.formData){c=[];a.each(b.formData,function(d,f){c.push({name:d,value:f})});return c}}}return[]},_getTotal:function(c){var b=0;a.each(c,function(d,f){b+=f.size||1});return b},_onProgress:function(f,d){if(f.lengthComputable){var c=d.total||this._getTotal(d.files),b=parseInt(f.loaded/f.total*(d.chunkSize||c),10)+(d.uploadedBytes||0);this._loaded+=b-(d.loaded||d.uploadedBytes||0);d.lengthComputable=true;d.loaded=b;d.total=c;this._trigger("progress",f,d);this._trigger("progressall",f,{lengthComputable:true,loaded:this._loaded,total:this._total})}},_initProgressListener:function(b){var c=this,d=b.xhr?b.xhr():a.ajaxSettings.xhr();if(d.upload&&d.upload.addEventListener){d.upload.addEventListener("progress",function(f){c._onProgress(f,b)},false);b.xhr=function(){return d}}},_initXHRData:function(b){var d,c=b.files[0];if(!b.multipart||b.blob){b.headers=a.extend(b.headers,{"X-File-Name":c.name,"X-File-Type":c.type,"X-File-Size":c.size});if(!b.blob){b.contentType=c.type;b.data=c}else{if(!b.multipart){b.contentType="application/octet-stream";b.data=b.blob}}}if(b.multipart&&typeof FormData!=="undefined"){if(b.formData instanceof FormData){d=b.formData}else{d=new FormData();a.each(this._getFormData(b),function(f,g){d.append(g.name,g.value)})}if(b.blob){d.append(b.paramName,b.blob)}else{a.each(b.files,function(f,g){if(g instanceof Blob){d.append(b.paramName,g)}})}b.data=d}b.blob=null},_initIframeSettings:function(b){b.dataType="iframe "+(b.dataType||"");b.formData=this._getFormData(b)},_initDataSettings:function(b){if(this._isXHRUpload(b)){if(!this._chunkedUpload(b,true)){if(!b.data){this._initXHRData(b)}this._initProgressListener(b)}}else{this._initIframeSettings(b)}},_initFormSettings:function(b){if(!b.form||!b.form.length){b.form=a(b.fileInput.prop("form"))}if(!b.paramName){b.paramName=b.fileInput.prop("name")||"files[]"}if(!b.url){b.url=b.form.prop("action")||location.href}b.type=(b.type||b.form.prop("method")||"").toUpperCase();if(b.type!=="POST"&&b.type!=="PUT"){b.type="POST"}},_getAJAXSettings:function(c){var b=a.extend({},this.options,c);this._initFormSettings(b);this._initDataSettings(b);return b},_enhancePromise:function(b){b.success=b.done;b.error=b.fail;b.complete=b.always;return b},_getXHRPromise:function(f,d,c){var b=a.Deferred(),g=b.promise();d=d||this.options.context||g;if(f===true){b.resolveWith(d,c)}else{if(f===false){b.rejectWith(d,c)}}g.abort=b.promise;return this._enhancePromise(g)},_chunkedUpload:function(o,j){var i=this,g=o.files[0],h=g.size,b=o.uploadedBytes=o.uploadedBytes||0,f=o.maxChunkSize||h,l=g.webkitSlice||g.mozSlice||g.slice,m,c,k,d;if(!(this._isXHRUpload(o)&&l&&(b||f<h))||o.data){return false}if(j){return true}if(b>=h){g.error="uploadedBytes";return this._getXHRPromise(false)}c=Math.ceil((h-b)/f);m=function(n){if(!n){return i._getXHRPromise(true)}return m(n-=1).pipe(function(){var p=a.extend({},o);p.blob=l.call(g,b+n*f,b+(n+1)*f);p.chunkSize=p.blob.size;i._initXHRData(p);i._initProgressListener(p);k=(a.ajax(p)||i._getXHRPromise(false,p.context)).done(function(){if(!p.loaded){i._onProgress(a.Event("progress",{lengthComputable:true,loaded:p.chunkSize,total:p.chunkSize}),p)}o.uploadedBytes=p.uploadedBytes+=p.chunkSize});return k})};d=m(c);d.abort=function(){return k.abort()};return this._enhancePromise(d)},_beforeSend:function(c,b){if(this._active===0){this._trigger("start")}this._active+=1;this._loaded+=b.uploadedBytes||0;this._total+=this._getTotal(b.files)},_onDone:function(b,f,d,c){if(!this._isXHRUpload(c)){this._onProgress(a.Event("progress",{lengthComputable:true,loaded:1,total:1}),c)}c.result=b;c.textStatus=f;c.jqXHR=d;this._trigger("done",null,c)},_onFail:function(c,f,d,b){b.jqXHR=c;b.textStatus=f;b.errorThrown=d;this._trigger("fail",null,b);if(b.recalculateProgress){this._loaded-=b.loaded||b.uploadedBytes||0;this._total-=b.total||this._getTotal(b.files)}},_onAlways:function(b,g,d,f,c){this._active-=1;c.result=b;c.textStatus=g;c.jqXHR=d;c.errorThrown=f;this._trigger("always",null,c);if(this._active===0){this._trigger("stop");this._loaded=this._total=0}},_onSend:function(i,g){var f=this,d,j,c,b=f._getAJAXSettings(g),h=function(l,k){f._sending+=1;d=d||((l!==false&&f._trigger("send",i,b)!==false&&(f._chunkedUpload(b)||a.ajax(b)))||f._getXHRPromise(false,b.context,k)).done(function(m,o,n){f._onDone(m,o,n,b)}).fail(function(m,o,n){f._onFail(m,o,n,b)}).always(function(n,m,p){f._sending-=1;if(p&&p.done){f._onAlways(n,m,p,undefined,b)}else{f._onAlways(undefined,m,n,p,b)}if(b.limitConcurrentUploads&&b.limitConcurrentUploads>f._sending){var o=f._slots.shift();while(o){if(!o.isRejected()){o.resolve();break}o=f._slots.shift()}}});return d};this._beforeSend(i,b);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){j=a.Deferred();this._slots.push(j);c=j.pipe(h)}else{c=(this._sequence=this._sequence.pipe(h,h))}c.abort=function(){var k=[undefined,"abort","abort"];if(!d){if(j){j.rejectWith(k)}return h(false,k)}return d.abort()};return this._enhancePromise(c)}return h()},_onAdd:function(g,f){var d=this,b=true,c=a.extend({},this.options,f);if(c.singleFileUploads&&this._isXHRUpload(c)){a.each(f.files,function(h,i){var j=a.extend({},f,{files:[i]});j.submit=function(){return d._onSend(g,j)};return(b=d._trigger("add",g,j))});return b}else{if(f.files.length){f=a.extend({},f);f.submit=function(){return d._onSend(g,f)};return this._trigger("add",g,f)}}},_normalizeFile:function(b,c){if(c.name===undefined&&c.size===undefined){c.name=c.fileName;c.size=c.fileSize}},_replaceFileInput:function(b){var c=b.clone(true);a("<form></form>").append(c)[0].reset();b.after(c).detach();this.options.fileInput=this.options.fileInput.map(function(d,f){if(f===b[0]){return c[0]}return f})},_onChange:function(d){var b=d.data.fileupload,c={files:a.each(a.makeArray(d.target.files),b._normalizeFile),fileInput:a(d.target),form:a(d.target.form)};if(!c.files.length){c.files=[{name:d.target.value.replace(/^.*\\/,"")}]}if(c.form.length){c.fileInput.data("blueimp.fileupload.form",c.form)}else{c.form=c.fileInput.data("blueimp.fileupload.form")}if(b.options.replaceFileInput){b._replaceFileInput(c.fileInput)}if(b._trigger("change",d,c)===false||b._onAdd(d,c)===false){return false}},_onDrop:function(f){var b=f.data.fileupload,d=f.dataTransfer=f.originalEvent.dataTransfer,c={files:a.each(a.makeArray(d&&d.files),b._normalizeFile)};if(b._trigger("drop",f,c)===false||b._onAdd(f,c)===false){return false}f.preventDefault()},_onDragOver:function(d){var b=d.data.fileupload,c=d.dataTransfer=d.originalEvent.dataTransfer;if(b._trigger("dragover",d)===false){return false}if(c){c.dropEffect=c.effectAllowed="copy"}d.preventDefault()},_initEventHandlers:function(){var b=this.options.namespace||this.name;this.options.dropZone.bind("dragover."+b,{fileupload:this},this._onDragOver).bind("drop."+b,{fileupload:this},this._onDrop);this.options.fileInput.bind("change."+b,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var b=this.options.namespace||this.name;this.options.dropZone.unbind("dragover."+b,this._onDragOver).unbind("drop."+b,this._onDrop);this.options.fileInput.unbind("change."+b,this._onChange)},_beforeSetOption:function(b,c){this._destroyEventHandlers()},_afterSetOption:function(c,d){var b=this.options;if(!b.fileInput){b.fileInput=a()}if(!b.dropZone){b.dropZone=a()}this._initEventHandlers()},_setOption:function(b,d){var c=a.inArray(b,this._refreshOptionsList)!==-1;if(c){this._beforeSetOption(b,d)}a.Widget.prototype._setOption.call(this,b,d);if(c){this._afterSetOption(b,d)}},_create:function(){var b=this.options;if(b.fileInput===undefined){b.fileInput=this.element.is("input:file")?this.element:this.element.find("input:file")}else{if(!b.fileInput){b.fileInput=a()}}if(!b.dropZone){b.dropZone=a()}this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=this._loaded=this._total=0;this._initEventHandlers()},destroy:function(){this._destroyEventHandlers();a.Widget.prototype.destroy.call(this)},enable:function(){a.Widget.prototype.enable.call(this);this._initEventHandlers()},disable:function(){this._destroyEventHandlers();a.Widget.prototype.disable.call(this)},add:function(b){if(!b||this.options.disabled){return}b.files=a.each(a.makeArray(b.files),this._normalizeFile);this._onAdd(null,b)},send:function(b){if(b&&!this.options.disabled){b.files=a.each(a.makeArray(b.files),this._normalizeFile);if(b.files.length){return this._onSend(null,b)}}return this._getXHRPromise(false,b&&b.context)}})}(jQuery));(function(b){var a=0;b.ajaxTransport("iframe",function(c,h,g){if(c.type==="POST"||c.type==="GET"){var f,d;return{send:function(j,i){f=b('<form style="display:none;"></form>');d=b('<iframe src="javascript:false;" name="iframe-transport-'+(a+=1)+'"></iframe>').bind("load",function(){var k;var l=function(n){if(n.data){var m;try{m=n.data;if(!m.length){throw new Error()}}catch(o){m=undefined}i(200,"success",{iframe:m});b('<iframe src="javascript:false;"></iframe>').appendTo(f);f.remove()}};if(typeof window.addEventListener!="undefined"){window.addEventListener("message",l,false)}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onmessage",l)}}d.unbind("load").bind("load",function(){});f.prop("target",d.prop("name")).prop("action",c.url).prop("method",c.type);if(c.formData){b.each(c.formData,function(m,n){b('<input type="hidden"/>').prop("name",n.name).val(n.value).appendTo(f)})}if(c.fileInput&&c.fileInput.length&&c.type==="POST"){k=c.fileInput.clone();c.fileInput.after(function(m){return k[m]});if(c.paramName){c.fileInput.each(function(){b(this).prop("name",c.paramName)})}f.append(c.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")}f.submit();if(k&&k.length){c.fileInput.each(function(n,m){var o=b(k[n]);b(m).prop("name",o.prop("name"));o.replaceWith(m)})}});f.append(d).appendTo("body")},abort:function(){if(d){d.unbind("load").prop("src","javascript".concat(":false;"))}if(f){f.remove()}}}}});b.ajaxSetup({converters:{"iframe text":function(c){return c.text()},"iframe json":function(c){return b.parseJSON(c)},"iframe html":function(c){return c.find("body").html()},"iframe script":function(c){return b.globalEval(c.text())}}})}(jQuery));var OAuth;if(OAuth==null){OAuth={}}OAuth.setProperties=function setProperties(a,c){if(a!=null&&c!=null){for(var b in c){a[b]=c[b]}}return a};OAuth.setProperties(OAuth,{percentEncode:function percentEncode(b){if(b==null){return""}if(b instanceof Array){var c="";for(var a=0;a<b.length;++b){if(c!=""){c+="&"}c+=OAuth.percentEncode(b[a])}return c}b=encodeURIComponent(b);b=b.replace(/\!/g,"%21");b=b.replace(/\*/g,"%2A");b=b.replace(/\'/g,"%27");b=b.replace(/\(/g,"%28");b=b.replace(/\)/g,"%29");return b},decodePercent:function decodePercent(a){if(a!=null){a=a.replace(/\+/g," ")}return decodeURIComponent(a)},getParameterList:function getParameterList(a){if(a==null){return[]}if(typeof a!="object"){return OAuth.decodeForm(a+"")}if(a instanceof Array){return a}var b=[];for(var c in a){b.push([c,a[c]])}return b},getParameterMap:function getParameterMap(b){if(b==null){return{}}if(typeof b!="object"){return OAuth.getParameterMap(OAuth.decodeForm(b+""))}if(b instanceof Array){var d={};for(var c=0;c<b.length;++c){var a=b[c][0];if(d[a]===undefined){d[a]=b[c][1]}}return d}return b},getParameter:function getParameter(b,a){if(b instanceof Array){for(var c=0;c<b.length;++c){if(b[c][0]==a){return b[c][1]}}}else{return OAuth.getParameterMap(b)[a]}return null},formEncode:function formEncode(b){var a="";var d=OAuth.getParameterList(b);for(var f=0;f<d.length;++f){var c=d[f][1];if(c==null){c=""}if(a!=""){a+="&"}a+=OAuth.percentEncode(d[f][0])+"="+OAuth.percentEncode(c)}return a},decodeForm:function decodeForm(d){var g=[];var i=d.split("&");for(var h=0;h<i.length;++h){var a=i[h];if(a==""){continue}var c=a.indexOf("=");var b;var f;if(c<0){b=OAuth.decodePercent(a);f=null}else{b=OAuth.decodePercent(a.substring(0,c));f=OAuth.decodePercent(a.substring(c+1))}g.push([b,f])}return g},setParameter:function setParameter(c,a,d){var b=c.parameters;if(b instanceof Array){for(var f=0;f<b.length;++f){if(b[f][0]==a){if(d===undefined){b.splice(f,1)}else{b[f][1]=d;d=undefined}}}if(d!==undefined){b.push([a,d])}}else{b=OAuth.getParameterMap(b);b[a]=d;c.parameters=b}},setParameters:function setParameters(c,b){var d=OAuth.getParameterList(b);for(var a=0;a<d.length;++a){OAuth.setParameter(c,d[a][0],d[a][1])}},completeRequest:function completeRequest(b,a){if(b.method==null){b.method="GET"}var c=OAuth.getParameterMap(b.parameters);if(c.oauth_consumer_key==null){OAuth.setParameter(b,"oauth_consumer_key",a.consumerKey||"")}if(c.oauth_token==null&&a.token!=null){OAuth.setParameter(b,"oauth_token",a.token)}if(c.oauth_version==null){OAuth.setParameter(b,"oauth_version","1.0")}if(c.oauth_timestamp==null){OAuth.setParameter(b,"oauth_timestamp",OAuth.timestamp())}if(c.oauth_nonce==null){OAuth.setParameter(b,"oauth_nonce",OAuth.nonce(6))}OAuth.SignatureMethod.sign(b,a)},setTimestampAndNonce:function setTimestampAndNonce(a){OAuth.setParameter(a,"oauth_timestamp",OAuth.timestamp());OAuth.setParameter(a,"oauth_nonce",OAuth.nonce(6))},addToURL:function addToURL(a,c){newURL=a;if(c!=null){var b=OAuth.formEncode(c);if(b.length>0){var d=a.indexOf("?");if(d<0){newURL+="?"}else{newURL+="&"}newURL+=b}}return newURL},getAuthorizationHeader:function getAuthorizationHeader(a,c){var h='OAuth realm="'+OAuth.percentEncode(a)+'"';var d=OAuth.getParameterList(c);for(var f=0;f<d.length;++f){var g=d[f];var b=g[0];if(b.indexOf("oauth_")==0){h+=","+OAuth.percentEncode(b)+'="'+OAuth.percentEncode(g[1])+'"'}}return h},correctTimestampFromSrc:function correctTimestampFromSrc(b){b=b||"oauth_timestamp";var a=document.getElementsByTagName("script");if(a==null||!a.length){return}var f=a[a.length-1].src;if(!f){return}var d=f.indexOf("?");if(d<0){return}parameters=OAuth.getParameterMap(OAuth.decodeForm(f.substring(d+1)));var c=parameters[b];if(c==null){return}OAuth.correctTimestamp(c)},correctTimestamp:function correctTimestamp(a){OAuth.timeCorrectionMsec=(a*1000)-(new Date()).getTime()},timeCorrectionMsec:0,timestamp:function timestamp(){var a=(new Date()).getTime()+OAuth.timeCorrectionMsec;return Math.floor(a/1000)},nonce:function nonce(f){var d=OAuth.nonce.CHARS;var a="";for(var c=0;c<f;++c){var b=Math.floor(Math.random()*d.length);a+=d.substring(b,b+1)}return a}});OAuth.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";OAuth.declareClass=function declareClass(d,a,c){var f=d[a];d[a]=c;if(c!=null&&f!=null){for(var b in f){if(b!="prototype"){c[b]=f[b]}}}return c};OAuth.declareClass(OAuth,"SignatureMethod",function OAuthSignatureMethod(){});OAuth.setProperties(OAuth.SignatureMethod.prototype,{sign:function sign(c){var b=OAuth.SignatureMethod.getBaseString(c);var a=this.getSignature(b);OAuth.setParameter(c,"oauth_signature",a);return a},initialize:function initialize(c,a){var b;if(a.accessorSecret!=null&&c.length>9&&c.substring(c.length-9)=="-Accessor"){b=a.accessorSecret}else{b=a.consumerSecret}this.key=OAuth.percentEncode(b)+"&"+OAuth.percentEncode(a.tokenSecret)}});OAuth.setProperties(OAuth.SignatureMethod,{sign:function sign(c,a){var b=OAuth.getParameterMap(c.parameters).oauth_signature_method;if(b==null||b==""){b="HMAC-SHA1";OAuth.setParameter(c,"oauth_signature_method",b)}OAuth.SignatureMethod.newMethod(b,a).sign(c)},newMethod:function newMethod(d,a){var c=OAuth.SignatureMethod.REGISTERED[d];if(c!=null){var h=new c();h.initialize(d,a);return h}var g=new Error("signature_method_rejected");var b="";for(var f in OAuth.SignatureMethod.REGISTERED){if(b!=""){b+="&"}b+=OAuth.percentEncode(f)}g.oauth_acceptable_signature_methods=b;throw g},REGISTERED:{},registerMethodClass:function registerMethodClass(b,a){for(var c=0;c<b.length;++c){OAuth.SignatureMethod.REGISTERED[b[c]]=a}},makeSubclass:function makeSubclass(a){var b=OAuth.SignatureMethod;var c=function(){b.call(this)};c.prototype=new b();c.prototype.getSignature=a;c.prototype.constructor=c;return c},getBaseString:function getBaseString(g){var b=g.action;var h=b.indexOf("?");var f;if(h<0){f=g.parameters}else{f=OAuth.decodeForm(b.substring(h+1));var d=OAuth.getParameterList(g.parameters);for(var c=0;c<d.length;++c){f.push(d[c])}}return OAuth.percentEncode(g.method.toUpperCase())+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeUrl(b))+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeParameters(f))},normalizeUrl:function normalizeUrl(c){var d=OAuth.SignatureMethod.parseUri(c);var a=d.protocol.toLowerCase();var g=d.authority.toLowerCase();var h=(a=="http"&&d.port==80)||(a=="https"&&d.port==443);if(h){var b=g.lastIndexOf(":");if(b>=0){g=g.substring(0,b)}}var f=d.path;if(!f){f="/"}return a+"://"+g+f},parseUri:function parseUri(f){var d={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};var a=d.parser.strict.exec(f);var c={};var b=14;while(b--){c[d.key[b]]=a[b]||""}return c},normalizeParameters:function normalizeParameters(d){if(d==null){return""}var f=OAuth.getParameterList(d);var h=[];for(var g=0;g<f.length;++g){var b=f[g];if(b[0]!="oauth_signature"){h.push([OAuth.percentEncode(b[0])+" "+OAuth.percentEncode(b[1]),b])}}h.sort(function(j,i){if(j[0]<i[0]){return -1}if(j[0]>i[0]){return 1}return 0});var a=[];for(var c=0;c<h.length;++c){a.push(h[c][1])}return OAuth.formEncode(a)}});OAuth.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],OAuth.SignatureMethod.makeSubclass(function getSignature(a){return this.key}));OAuth.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],OAuth.SignatureMethod.makeSubclass(function getSignature(b){b64pad="=";var a=b64_hmac_sha1(this.key,b);return a}));try{OAuth.correctTimestampFromSrc()}catch(e){}var hexcase=0;var b64pad="";var chrsz=8;function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length*chrsz))}function b64_sha1(a){return binb2b64(core_sha1(str2binb(a),a.length*chrsz))}function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length*chrsz))}function hex_hmac_sha1(a,b){return binb2hex(core_hmac_sha1(a,b))}function b64_hmac_sha1(a,b){return binb2b64(core_hmac_sha1(a,b))}function str_hmac_sha1(a,b){return binb2str(core_hmac_sha1(a,b))}function sha1_vm_test(){return hex_sha1("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function core_sha1(y,o){y[o>>5]|=128<<(24-o%32);y[((o+64>>9)<<4)+15]=o;var z=Array(80);var u=1732584193;var s=-271733879;var r=-1732584194;var q=271733878;var p=-1009589776;for(var l=0;l<y.length;l+=16){var n=u;var m=s;var k=r;var h=q;var f=p;for(var g=0;g<80;g++){if(g<16){z[g]=y[l+g]}else{z[g]=rol(z[g-3]^z[g-8]^z[g-14]^z[g-16],1)}var A=safe_add(safe_add(rol(u,5),sha1_ft(g,s,r,q)),safe_add(safe_add(p,z[g]),sha1_kt(g)));p=q;q=r;r=rol(s,30);s=u;u=A}u=safe_add(u,n);s=safe_add(s,m);r=safe_add(r,k);q=safe_add(q,h);p=safe_add(p,f)}return Array(u,s,r,q,p)}function sha1_ft(f,a,h,g){if(f<20){return(a&h)|((~a)&g)}if(f<40){return a^h^g}if(f<60){return(a&h)|(a&g)|(h&g)}return a^h^g}function sha1_kt(a){return(a<20)?1518500249:(a<40)?1859775393:(a<60)?-1894007588:-899497514}function core_hmac_sha1(c,g){var f=str2binb(c);if(f.length>16){f=core_sha1(f,c.length*chrsz)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=f[b]^909522486;d[b]=f[b]^1549556828}var h=core_sha1(a.concat(str2binb(g)),512+g.length*chrsz);return core_sha1(d.concat(h),512+160)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function rol(a,b){return(a<<b)|(a>>>(32-b))}function str2binb(d){var c=Array();var a=(1<<chrsz)-1;for(var b=0;b<d.length*chrsz;b+=chrsz){c[b>>5]|=(d.charCodeAt(b/chrsz)&a)<<(32-chrsz-b%32)}return c}function binb2str(c){var d="";var a=(1<<chrsz)-1;for(var b=0;b<c.length*32;b+=chrsz){d+=String.fromCharCode((c[b>>5]>>>(32-chrsz-b%32))&a)}return d}function binb2hex(c){var b=hexcase?"0123456789ABCDEF":"0123456789abcdef";var d="";for(var a=0;a<c.length*4;a++){d+=b.charAt((c[a>>2]>>((3-a%4)*8+4))&15)+b.charAt((c[a>>2]>>((3-a%4)*8))&15)}return d}function binb2b64(d){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var g="";for(var b=0;b<d.length*4;b+=3){var f=(((d[b>>2]>>8*(3-b%4))&255)<<16)|(((d[b+1>>2]>>8*(3-(b+1)%4))&255)<<8)|((d[b+2>>2]>>8*(3-(b+2)%4))&255);for(var a=0;a<4;a++){if(b*8+a*6>d.length*32){g+=b64pad}else{g+=c.charAt((f>>6*(3-a))&63)}}}return g}var com;if(!com){com={}}if(!com.cocoafish){com.cocoafish={}}if(!com.cocoafish.constants){com.cocoafish.constants={}}if(!com.cocoafish.js){com.cocoafish.js={}}if(!com.cocoafish.js.sdk){com.cocoafish.js.sdk={}}if(!com.cocoafish.js.sdk.utils){com.cocoafish.js.sdk.utils={}}if(!com.cocoafish.sdk){com.cocoafish.sdk={}}if(!com.cocoafish.sdk.url){com.cocoafish.sdk.url={}}com.cocoafish.sdk.url.http="http://";com.cocoafish.sdk.url.https="https://";com.cocoafish.sdk.url.baseURL="api.cloud.appcelerator.com";com.cocoafish.sdk.url.authBaseURL="secure-identity.cloud.appcelerator.com";com.cocoafish.sdk.url.version="v1";com.cocoafish.constants.get_method="GET";com.cocoafish.constants.post_method="POST";com.cocoafish.constants.put_method="PUT";com.cocoafish.constants.delete_method="DELETE";com.cocoafish.constants.app_key=1;com.cocoafish.constants.oauth=2;com.cocoafish.constants.three_legged_oauth=3;com.cocoafish.constants.unknown=-1;com.cocoafish.constants.keyParam="?key=";com.cocoafish.constants.oauthKeyParam="?oauth_consumer_key=";com.cocoafish.constants.clientIdParam="?client_id=";com.cocoafish.constants.redirectUriParam="&redirect_uri=";com.cocoafish.constants.responseTypeParam="&response_type=";com.cocoafish.constants.accessToken="access_token";com.cocoafish.constants.expiresIn="expires_in";com.cocoafish.constants.appKey="app_key";com.cocoafish.constants.json="json";com.cocoafish.constants.sessionId="_session_id";com.cocoafish.constants.sessionCookieName="Cookie";com.cocoafish.constants.responseCookieName="Set-Cookie";com.cocoafish.constants.ie="MSIE";com.cocoafish.constants.ie_v7=7;com.cocoafish.constants.file="file";com.cocoafish.constants.userId="user_id";com.cocoafish.constants.placeId="place_id";com.cocoafish.constants.suppressCode="suppress_response_codes";com.cocoafish.constants.response_wrapper="response_wrapper";com.cocoafish.constants.ie_post_message="ie_post_message";com.cocoafish.constants.photo="photo";com.cocoafish.constants.method="_method";com.cocoafish.constants.name="name";com.cocoafish.constants.value="value";com.cocoafish.constants.oauth_header="Authorization";com.cocoafish.constants.noAppKeyError={meta:{status:"fail",code:409,message:"Application key is not provided."}};com.cocoafish.constants.fileLoadError={meta:{status:"fail",code:400,message:"Unable to load file"}};com.cocoafish.constants.invalidArgumentError={meta:{status:"fail",code:400,message:"Invalid number of arguments, expecting at least 4 arguments."}};com.cocoafish.constants.appcelerator="Appcelerator";com.cocoafish.js.sdk.utils.getSessionParams=function(){var a=null;var b=com.cocoafish.js.sdk.utils.getCookie(com.cocoafish.constants.sessionId);if(b){a=com.cocoafish.constants.sessionId+"="+b}return a};com.cocoafish.js.sdk.utils.trim=function(a){if(a){return a.replace(/(^\s*)(\s*$)/g,"")}return""};com.cocoafish.js.sdk.utils.checkAppcelerator=function(){try{Titanium.userAgent;return true}catch(a){return false}};com.cocoafish.js.sdk.utils.BrowserDetect={init:function(){if(com.cocoafish.js.sdk.utils.checkAppcelerator()){this.browser=com.cocoafish.constants.appcelerator;agent=Titanium.userAgent;if(agent){v=agent.substring(agent.indexOf("/")+1,agent.indexOf("("));osStr=agent.substring(agent.indexOf("(")+1,agent.indexOf(")"));var a=osStr.split(";");if(v){this.version=com.cocoafish.js.sdk.utils.trim(v)}if(a&&a.length>2){this.OS=com.cocoafish.js.sdk.utils.trim(a[1])}}}else{this.dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"MSIE",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}];this.dataOS=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"}},searchString:function(d){for(var a=0;a<d.length;a++){var b=d[a].string;var c=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(b){if(b.indexOf(d[a].subString)!=-1){return d[a].identity}}else{if(c){return d[a].identity}}}},searchVersion:function(b){var a=b.indexOf(this.versionSearchString);if(a==-1){return}return parseFloat(b.substring(a+this.versionSearchString.length+1))}};com.cocoafish.js.sdk.utils.BrowserDetect.init();com.cocoafish.js.sdk.utils.getCookie=function(a){var h=document.cookie.split(";");var c="";var f="";var g="";var d=false;var b="";for(b=0;b<h.length;b++){c=h[b].split("=");f=c[0].replace(/^\s+|\s+$/g,"");if(f==a){d=true;if(c.length>1){g=unescape(c[1].replace(/^\s+|\s+$/g,""))}return g;break}c=null;f=""}if(!d){return null}};com.cocoafish.js.sdk.utils.setCookie=function(c,f,a,i,d,h){var b=new Date();b.setTime(b.getTime());if(a){a=a*1000*60*60*24}var g=new Date(b.getTime()+(a));document.cookie=c+"="+escape(f)+((a)?";expires="+g.toGMTString():"")+((i)?";path="+i:"")+((d)?";domain="+d:"")+((h)?";secure":"")};com.cocoafish.js.sdk.utils.deleteCookie=function(a,c,b){if(com.cocoafish.js.sdk.utils.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}};com.cocoafish.js.sdk.utils.getAuthType=function(a){if(a){if(a.isThreeLegged()){return com.cocoafish.constants.three_legged_oauth}else{if(a.appKey){return com.cocoafish.constants.app_key}else{if(a.oauthKey&&a.oauthSecret){return com.cocoafish.constants.oauth}}}}return com.cocoafish.constants.unknown};com.cocoafish.js.sdk.utils.prepareFormData=function(c){if(window.FormData){var d=new FormData();if(c){for(prop in c){if(!c.hasOwnProperty(prop)){continue}if(prop==com.cocoafish.constants.photo||prop==com.cocoafish.constants.file){var a=c[prop];var b=document.getElementById(a);if(b&&b.files[0]){d.append(prop,b.files[0])}}else{d.append(prop,c[prop])}}}return d}};com.cocoafish.js.sdk.utils.prepareFormDataArray=function(c){var b=new Array();if(c){for(prop in c){if(!c.hasOwnProperty(prop)){continue}if(prop!=com.cocoafish.constants.photo&&prop!=com.cocoafish.constants.file){var a=new Object();a[com.cocoafish.constants.name]=prop;a[com.cocoafish.constants.value]=c[prop];b.push(a)}}}return b};com.cocoafish.js.sdk.utils.getFileObject=function(c){if(c){for(prop in c){if(!c.hasOwnProperty(prop)){continue}if(prop==com.cocoafish.constants.photo||prop==com.cocoafish.constants.file){if(com.cocoafish.js.sdk.utils.BrowserDetect.browser==com.cocoafish.constants.appcelerator){return c[prop]}else{var a=c[prop];var b=$("#"+a);return b}}}}return null};com.cocoafish.js.sdk.utils.cleanInvalidData=function(a){if(a){for(prop in a){if(!a.hasOwnProperty(prop)){continue}if(a[prop]==null){delete a[prop]}}return a}else{return{}}};com.cocoafish.js.sdk.utils.uploadMessageCallback=function(a){if(a&&a.data){return $.parseJSON(a.data)}else{return{}}};com.cocoafish.js.sdk.utils.getOAuthParameters=function(c){var a="";if(c){var d=OAuth.getParameterList(c);for(var f=0;f<d.length;++f){var g=d[f];var b=g[0];if(b.indexOf("oauth_")==0&&b!="oauth_token"){a+="&"+OAuth.percentEncode(b)+"="+OAuth.percentEncode(g[1])}}}if(a.length>0){a=a.substring(1)}return a};com.cocoafish.js.sdk.utils.populateOAuthParameters=function(b,a){if(b&&a){b.push(["oauth_version","1.0"]);b.push(["oauth_consumer_key",a]);b.push(["oauth_signature_method","HMAC-SHA1"]);b.push(["oauth_nonce",OAuth.nonce(15)])}};com.cocoafish.js.sdk.utils.sendAppceleratorRequest=function(b,a,f,g,i,h){var j=Titanium.Network.createHTTPClient();j.setTimeout(60000);j.onerror=function(m){var k=this.responseText;var l=JSON.parse(k);if(l&&l.meta){l.metaString=JSON.stringify(l.meta)}i(l)};j.onload=function(m){var k=this.responseText;var l=JSON.parse(k);if(l&&l.meta){l.metaString=JSON.stringify(l.meta);if(l.meta.session_id){var n=l.meta.session_id;com.cocoafish.js.sdk.utils.setCookie(com.cocoafish.constants.sessionId,n);h.session_id=n}}i(l)};var c=b;if(a.toUpperCase()==com.cocoafish.constants.get_method){if(f){var d="";for(prop in f){if(!f.hasOwnProperty(prop)){continue}d+="&"+prop+"="+f[prop]}if(d.length>0){if(b.indexOf("?")>0){c+=d}else{c+="?"+d.substring(1)}f={}}}}j.open(a,c);if(g){for(prop in g){if(!g.hasOwnProperty(prop)){continue}j.setRequestHeader(prop,g[prop])}}j.send(f)};com.cocoafish.js.sdk.utils.encodeQS=function(d,a,b){a=a===undefined?"&":a;b=b===false?function(f){return f}:encodeURIComponent;var c=[];com.cocoafish.js.sdk.utils.forEach(d,function(g,f){if(g!==null&&typeof g!="undefined"){c.push(b(f)+"="+b(g))}});c.sort();return c.join(a)};com.cocoafish.js.sdk.utils.decodeQS=function(g){var c=decodeURIComponent,f={},b=g.split("&"),a,d;for(a=0;a<b.length;a++){d=b[a].split("=",2);if(d&&d[0]){f[c(d[0])]=c(d[1])}}return f};com.cocoafish.js.sdk.utils.guid=function(){return"f"+(Math.random()*(1<<30)).toString(16).replace(".","")};com.cocoafish.js.sdk.utils.copy=function(f,d,b,a){for(var c in d){if(b||typeof f[c]==="undefined"){f[c]=a?a(d[c]):d[c]}}return f};com.cocoafish.js.sdk.utils.forEach=function(g,d,f){if(!g){return}if(Object.prototype.toString.apply(g)==="[object Array]"||(!(g instanceof Function)&&typeof g.length=="number")){if(g.forEach){g.forEach(d)}else{for(var c=0,a=g.length;c<a;c++){d(g[c],c,g)}}}else{for(var b in g){if(f||g.hasOwnProperty(b)){d(g[b],b,g)}}}};function Cocoafish(f,a,g,h,c){var b=false;var d="POPUP";if(!a){this.appKey=f}else{this.oauthKey=f;this.oauthSecret=a}if(g){this.apiBaseURL=g}else{this.apiBaseURL=com.cocoafish.sdk.url.baseURL}if(h){this.authBaseURL=h}else{this.authBaseURL=com.cocoafish.sdk.url.authBaseURL}if(c){this.redirectUri=c}this.useThreeLegged=function(i){b=i;if(!this.oauthKey){this.oauthKey=this.appKey}};this.isThreeLegged=function(){return b};this.setUIMode=function(i){d=i};this.getUIMode=function(){return d};return this}Cocoafish.prototype.sendRequest=function(j,i,A,k,r){var t=com.cocoafish.js.sdk.utils.getAuthType(this);if(t==com.cocoafish.constants.unknown){k(com.cocoafish.constants.noAppKeyError);return}var c=true;if(arguments.length==4){c=true}else{if(arguments.length==5){if(typeof(k)=="boolean"){c=k;k=r}else{c=r}}else{k(com.cocoafish.constants.invalidArgumentError);return}}var o="";if(c){o+=com.cocoafish.sdk.url.https}else{o+=com.cocoafish.sdk.url.http}o+=this.apiBaseURL+"/"+com.cocoafish.sdk.url.version+"/"+j;if(t==com.cocoafish.constants.app_key){o+=com.cocoafish.constants.keyParam+this.appKey}else{if(com.cocoafish.js.sdk.utils.BrowserDetect.browser!=com.cocoafish.constants.ie){o+=com.cocoafish.constants.oauthKeyParam+this.oauthKey}}var B=this;var q=function(D,C,F){if(D&&D.meta&&D.meta.session_id){var E=D.meta.session_id;com.cocoafish.js.sdk.utils.setCookie(com.cocoafish.constants.sessionId,E);B.session_id=E}k(D)};if(A==null){A={}}var m=i?i.toUpperCase():com.cocoafish.constants.get_method;if(com.cocoafish.js.sdk.utils.BrowserDetect.browser==com.cocoafish.constants.ie){if(m==com.cocoafish.constants.put_method||m==com.cocoafish.constants.delete_method){A[com.cocoafish.constants.method]=m;m=com.cocoafish.constants.post_method}}A[com.cocoafish.constants.suppressCode]="true";if(!this.isThreeLegged()){var x=com.cocoafish.js.sdk.utils.getCookie(com.cocoafish.constants.sessionId);if(!x){x=this.session_id}if(x){if(o.indexOf("?")!=-1){o+="&"+com.cocoafish.constants.sessionId+"="+x}else{o+="?"+com.cocoafish.constants.sessionId+"="+x}}}if(this.isThreeLegged()){if(!this.accessToken){var d=this.getSession();if(d){this.accessToken=d.access_token}}if(this.accessToken){A[com.cocoafish.constants.accessToken]=this.accessToken}}A=com.cocoafish.js.sdk.utils.cleanInvalidData(A);var z=com.cocoafish.js.sdk.utils.getFileObject(A);if(z){if(com.cocoafish.js.sdk.utils.BrowserDetect.browser==com.cocoafish.constants.ie){var h=com.cocoafish.js.sdk.utils.prepareFormDataArray(A);var b={name:com.cocoafish.constants.suppressCode,value:true};h.push(b);var f=com.cocoafish.constants.ie_post_message;var w={name:com.cocoafish.constants.response_wrapper,value:f};h.push(w);var u={};if((t==com.cocoafish.constants.oauth||t==com.cocoafish.constants.three_legged_oauth)){var n={method:m,action:o,parameters:[]};com.cocoafish.js.sdk.utils.populateOAuthParameters(n.parameters,this.oauthKey);if(this.oauthSecret){OAuth.completeRequest(n,{consumerSecret:this.oauthSecret})}var l=com.cocoafish.js.sdk.utils.getOAuthParameters(n.parameters);if(l&&o.indexOf("?")!=-1){o+="&"+l}else{o+="?"+l}}var p=z.fileupload({dataType:com.cocoafish.constants.json,url:o,headers:u,formData:function(C){return h},done:function(D,C){k(C.result)}});var g="";if(A.file){g=com.cocoafish.constants.file}else{if(A.photo){g=com.cocoafish.constants.photo}}z.prop(com.cocoafish.constants.name,g);p.fileupload("send",{files:[{name:g}]})}else{if(com.cocoafish.js.sdk.utils.BrowserDetect.browser==com.cocoafish.constants.appcelerator){if(z){try{var a;if(z.toString().match(/TiFilesystemFile/)){a=z.read()}else{a=z}if(!a){k(com.cocoafish.constants.fileLoadError);return}if(A[com.cocoafish.constants.file]){delete A[com.cocoafish.constants.file];A[com.cocoafish.constants.file]=a}else{if(A[com.cocoafish.constants.photo]){delete A[com.cocoafish.constants.photo];A[com.cocoafish.constants.photo]=a}}}catch(y){k(com.cocoafish.constants.fileLoadError);return}var u={};if((t==com.cocoafish.constants.oauth||t==com.cocoafish.constants.three_legged_oauth)){var n={method:m,action:o,parameters:[]};com.cocoafish.js.sdk.utils.populateOAuthParameters(n.parameters,this.oauthKey);if(this.oauthSecret){OAuth.completeRequest(n,{consumerSecret:this.oauthSecret})}u[com.cocoafish.constants.oauth_header]=OAuth.getAuthorizationHeader("",n.parameters)}com.cocoafish.js.sdk.utils.sendAppceleratorRequest(o,m,A,u,k,this)}else{k(com.cocoafish.constants.fileLoadError)}}else{var s=com.cocoafish.js.sdk.utils.prepareFormData(A);s.append(com.cocoafish.constants.suppressCode,true);var u={};if((t==com.cocoafish.constants.oauth||t==com.cocoafish.constants.three_legged_oauth)){var n={method:m,action:o,parameters:[]};com.cocoafish.js.sdk.utils.populateOAuthParameters(n.parameters,this.oauthKey);if(this.oauthSecret){OAuth.completeRequest(n,{consumerSecret:this.oauthSecret})}u[com.cocoafish.constants.oauth_header]=OAuth.getAuthorizationHeader("",n.parameters)}$.postCORSWithFile(o,s,q,com.cocoafish.constants.json,u,{withCredentials:true})}}}else{var u={};if((t==com.cocoafish.constants.oauth||t==com.cocoafish.constants.three_legged_oauth)){var n={method:m,action:o,parameters:[]};for(prop in A){if(!A.hasOwnProperty(prop)){continue}n.parameters.push([prop,A[prop]])}com.cocoafish.js.sdk.utils.populateOAuthParameters(n.parameters,this.oauthKey);if(this.oauthSecret){OAuth.completeRequest(n,{consumerSecret:this.oauthSecret})}if(com.cocoafish.js.sdk.utils.BrowserDetect.browser==com.cocoafish.constants.ie){var l=com.cocoafish.js.sdk.utils.getOAuthParameters(n.parameters);if(l&&o.indexOf("?")!=-1){o+="&"+l}else{o+="?"+l}}else{u[com.cocoafish.constants.oauth_header]=OAuth.getAuthorizationHeader("",n.parameters)}}if(com.cocoafish.js.sdk.utils.BrowserDetect.browser==com.cocoafish.constants.appcelerator){com.cocoafish.js.sdk.utils.sendAppceleratorRequest(o,m,A,u,k,this)}else{if(i.toUpperCase()==com.cocoafish.constants.get_method){$.getCORS(o,A,q,com.cocoafish.constants.json,u)}else{if(i.toUpperCase()==com.cocoafish.constants.post_method){$.postCORS(o,A,q,com.cocoafish.constants.json,u,{withCredentials:true})}else{if(i.toUpperCase()==com.cocoafish.constants.put_method){$.putCORS(o,A,q,com.cocoafish.constants.json,u,{withCredentials:true})}else{if(i.toUpperCase()==com.cocoafish.constants.delete_method){$.deleteCORS(o,A,q,com.cocoafish.constants.json,u,{withCredentials:true})}}}}}}};Cocoafish.prototype.sendAuthRequest=function(d){var c=com.cocoafish.js.sdk.utils.getAuthType(this);if(c!==com.cocoafish.constants.three_legged_oauth){alert("wrong authorization type!");return}d=d||{};var f=false;if(typeof(d.useSecure)=="boolean"){f=d.useSecure}var b="";if(f){b+=com.cocoafish.sdk.url.https}else{b+=com.cocoafish.sdk.url.http}b+=this.authBaseURL;b+="/oauth/authorize";b+=com.cocoafish.constants.clientIdParam+this.oauthKey;b+=com.cocoafish.constants.responseTypeParam+"token";if(d.redirectUri){b+=com.cocoafish.constants.redirectUriParam+d.redirectUri}else{b+=com.cocoafish.constants.redirectUriParam+this.redirectUri}if(this.getUIMode()==="POPUP"){var h=d.params||{};h.action="login";h.url=b;var g=this;var a=h.cb;if(a){delete h.cb}com.cocoafish.js.sdk.ui(h,function(i){g.saveSession(i);a&&a(i)})}else{window.location=b}};Cocoafish.prototype.signUpRequest=function(d){var c=com.cocoafish.js.sdk.utils.getAuthType(this);if(c!==com.cocoafish.constants.three_legged_oauth){alert("wrong authorization type!");return}d=d||{};var f=false;if(typeof(d.useSecure)=="boolean"){f=d.useSecure}var b="";if(f){b+=com.cocoafish.sdk.url.https}else{b+=com.cocoafish.sdk.url.http}b+=this.authBaseURL;b+="/users/sign_up";b+=com.cocoafish.constants.clientIdParam+this.oauthKey;if(d.redirectUri){b+=com.cocoafish.constants.redirectUriParam+d.redirectUri}else{b+=com.cocoafish.constants.redirectUriParam+this.redirectUri}if(this.getUIMode()==="POPUP"){var h=d.params||{};h.action="signup";h.url=b;var g=this;var a=h.cb;if(a){delete h.cb}com.cocoafish.js.sdk.ui(h,function(i){g.saveSession(i);a&&a(i)})}else{window.location=b}};Cocoafish.prototype.saveSession=function(a){if(!a||!a.access_token){this.authorized=false;return false}com.cocoafish.js.sdk.utils.setCookie(com.cocoafish.constants.accessToken,a.access_token);com.cocoafish.js.sdk.utils.setCookie(com.cocoafish.constants.expiresIn,a.expires_in);this.accessToken=a.access_token;this.expiresIn=a.expires_in;this.authorized=true;return true};Cocoafish.prototype.getSession=function(){var a={};a.access_token=com.cocoafish.js.sdk.utils.getCookie(com.cocoafish.constants.accessToken);a.expires_in=com.cocoafish.js.sdk.utils.getCookie(com.cocoafish.constants.expiresIn);if(!a.access_token){this.authorized=false;return false}this.accessToken=a.access_token;this.expiresIn=a.expires_in;this.authorized=true;return a};Cocoafish.prototype.clearSession=function(){com.cocoafish.js.sdk.utils.setCookie(com.cocoafish.constants.accessToken,"");com.cocoafish.js.sdk.utils.setCookie(com.cocoafish.constants.expiresIn,"");delete this.accessToken;delete this.expiresIn;this.authorized=false};Cocoafish.prototype.checkStatus=function(){var c={};c.access_token=$.getURLParameter("access_token");c.expires_in=$.getURLParameter("expires_in");if(c.access_token){var b=this.saveSession(c);var a=$.getURLParameter("cb");if(a&&com.cocoafish.js.sdk.XD._callbacks[a]){com.cocoafish.js.sdk.XD._callbacks[a]()}window.location.hash="";return b}else{if(this.getSession()){return true}else{return false}}};com.cocoafish.js.sdk.XD={_origin:null,_transport:null,_callbacks:{},_forever:{},init:function(a){if(com.cocoafish.js.sdk.XD._origin){return}if(window.addEventListener&&window.postMessage&&(com.cocoafish.js.sdk.utils.BrowserDetect.browser!==com.cocoafish.constants.ie)){com.cocoafish.js.sdk.XD._origin=(window.location.protocol+"//"+window.location.host+"/"+com.cocoafish.js.sdk.utils.guid());com.cocoafish.js.sdk.XD.PostMessage.init();com.cocoafish.js.sdk.XD._transport="postmessage"}else{com.cocoafish.js.sdk.XD._transport="fragment"}},recv:function(b){if(typeof b=="string"){b=com.cocoafish.js.sdk.utils.decodeQS(b)}var a=com.cocoafish.js.sdk.XD._callbacks[b.cb];if(!com.cocoafish.js.sdk.XD._forever[b.cb]){delete com.cocoafish.js.sdk.XD._callbacks[b.cb]}a&&a(b)},PostMessage:{init:function(){var a=com.cocoafish.js.sdk.XD.PostMessage.onMessage;window.addEventListener?window.addEventListener("message",a,false):window.attachEvent("onmessage",a)},onMessage:function(a){com.cocoafish.js.sdk.XD.recv(a.data)}}};com.cocoafish.js.sdk.XD.init();com.cocoafish.js.sdk.UIManager={Actions:{},_active:{},_defaultCb:{},_iframeCb:{},processParams:function(g,a){var f=com.cocoafish.js.sdk.UIManager.Actions[g.action.toLowerCase()],h=com.cocoafish.js.sdk.utils.guid();if(!f){}else{com.cocoafish.js.sdk.utils.copy(g,f,false)}var d=g.display=="popup"?"opener":"parent";var c={cb:a,id:h,size:g.size||{},url:g.url+"&cb="+h+"&rl="+d+"&xd="+com.cocoafish.js.sdk.XD._transport,params:g};if(f&&f.transform){c=f.transform(c);if(!c){return}}var b=function(i){com.cocoafish.js.sdk.UIManager._xdRecv(i,a)};c.cb=b;com.cocoafish.js.sdk.XD._callbacks[c.id]=c.cb;return c},popup:function(k){var f=typeof window.screenX!="undefined"?window.screenX:window.screenLeft,c=typeof window.screenY!="undefined"?window.screenY:window.screenTop,j=typeof window.outerWidth!="undefined"?window.outerWidth:document.documentElement.clientWidth,h=typeof window.outerHeight!="undefined"?window.outerHeight:(document.documentElement.clientHeight-22),a=k.size.width,i=k.size.height,d=parseInt(f+((j-a)/2),10),g=parseInt(c+((h-i)/2.5),10),b=("location=0,scrollbars=1,width="+a+",height="+i+",left="+d+",top="+g);com.cocoafish.js.sdk.UIManager._active[k.id]=window.open(k.url,k.id,b)},hidden:function(d){d.className="CO_UI_Hidden";var a=jQuery("<div id='hiddendiv"+d.id+"'>");var c=a[0],b=c.style;b.position="absolute";b.top="-10000";b.width=b.height="0px";document.getElementsByTagName("body")[0].appendChild(c);d.root=c;com.cocoafish.js.sdk.UIManager._insertIframe(d)},iframe:function(b){if(!b.className){b.className="CO_UI_Dialog"}var a=$("<div id='dialog"+b.id+"'>");a.dialog({autoOpen:false,height:b.size.height,width:b.size.width,modal:true,resizable:false,title:"Login",closeText:"hide",dialogClass:"dialogStyle",beforeClose:function(c,d){}});b.root=a[0];a.dialog("open");com.cocoafish.js.sdk.UIManager._insertIframe(b)},_insertIframe:function(d){var g={id:d.id,name:d.id,url:d.url,root:d.root,className:d.className,width:d.size.width-30,height:d.size.height-50,onload:function(h){com.cocoafish.js.sdk.UIManager._active[d.id]=h}};var c=false,a=false;com.cocoafish.js.sdk.UIManager._iframeCb[g.id]=function(){if(c&&!a){a=true;g.onload&&g.onload(g.root.firstChild)}};if(document.attachEvent){var b=('<iframe id="'+g.id+'" name="'+g.name+'"'+(g.className?' class="'+g.className+'"':"")+' style="border:none;'+(g.width?"width:"+g.width+"px;":"")+(g.height?"height:"+g.height+"px;":"")+'" src="'+g.url+'" frameborder="0" scrolling="yes" allowtransparency="true" onload="com.cocoafish.js.sdk.UIManager._iframeCb.'+g.id+'()"></iframe>');g.root.innerHTML='<iframe src="javascript:false" frameborder="0" scrolling="no" style="height:1px"></iframe>';c=true;window.setTimeout(function(){g.root.innerHTML=b},0)}else{var f=document.createElement("iframe");f.id=g.id;f.name=g.name;f.onload=com.cocoafish.js.sdk.UIManager._iframeCb[g.id];f.style.border="none";f.style.overflowY="scroll";f.style.overflowX="hidden";if(g.className){f.className=g.className}if(g.height){f.style.height=g.height+"px"}if(g.width){f.style.width=g.width+"px"}g.root.appendChild(f);c=true;f.src=g.url}},_triggerDefault:function(a){com.cocoafish.js.sdk.UIManager._xdRecv({frame:a},com.cocoafish.js.sdk.UIManager._defaultCb[a]||function(){})},_popupMonitor:function(){var b;for(var f in com.cocoafish.js.sdk.UIManager._active){if(com.cocoafish.js.sdk.UIManager._active.hasOwnProperty(f)&&f in com.cocoafish.js.sdk.UIManager._defaultCb){var c=com.cocoafish.js.sdk.UIManager._active[f];try{if(c.tagName){continue}}catch(a){}try{if(c.closed){com.cocoafish.js.sdk.UIManager._triggerDefault(f)}else{b=true}}catch(d){}}}if(b&&!com.cocoafish.js.sdk.UIManager._popupInterval){com.cocoafish.js.sdk.UIManager._popupInterval=window.setInterval(com.cocoafish.js.sdk.UIManager._popupMonitor,100)}else{if(!b&&com.cocoafish.js.sdk.UIManager._popupInterval){window.clearInterval(com.cocoafish.js.sdk.UIManager._popupInterval);com.cocoafish.js.sdk.UIManager._popupInterval=null}}},_xdRecv:function(c,b){var d=com.cocoafish.js.sdk.UIManager._active[c.cb];try{$("#dialog"+c.cb).dialog("close");$("#dialog"+c.cb).remove();$("#hiddendiv"+c.cb).remove()}catch(a){}try{if(d&&d.close){d.close();com.cocoafish.js.sdk.UIManager._popupCount--}}catch(f){alert(f)}delete com.cocoafish.js.sdk.UIManager._active[c.cb];delete com.cocoafish.js.sdk.UIManager._defaultCb[c.cb];b(c)}};com.cocoafish.js.sdk.UIManager.Actions={login:{display:"popup",size:{width:515,height:380}},logout:{display:"hidden",size:{width:0,height:0}},signup:{display:"popup",size:{width:515,height:650}}};com.cocoafish.js.sdk.ui=function(d,a){if(!d.action){alert('"action" is a required parameter for com.cocoafish.js.sdk.ui().');return}var c=com.cocoafish.js.sdk.UIManager.processParams(d,a);if(!c){return}else{}var b=d.display;var f=com.cocoafish.js.sdk.UIManager[b];if(!f){alert('"display" must be one of "popup", "iframe" or "hidden".');return}f(c)};